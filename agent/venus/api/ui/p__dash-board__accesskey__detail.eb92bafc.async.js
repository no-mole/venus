"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[421],{37655:function(e,n,t){var r=t(56453),a=t(30486),u=t(62086),o=t(63502),s=t(93236),c=t(84650),i=t(12961),p=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","showSearch","options"],l=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","options"],d=s.forwardRef((function(e,n){var t=e.fieldProps,l=e.children,d=e.params,f=e.proFieldProps,h=e.mode,m=e.valueEnum,v=e.request,w=e.showSearch,k=e.options,y=(0,a.Z)(e,p),x=(0,s.useContext)(c.Z);return(0,u.jsx)(i.Z,(0,r.Z)((0,r.Z)({valueEnum:(0,o.h)(m),request:v,params:d,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:(0,r.Z)({options:k,mode:h,showSearch:w,getPopupContainer:x.getPopupContainer},t),ref:n,proFieldProps:f},y),{},{children:l}))})),f=s.forwardRef((function(e,n){var t=e.fieldProps,p=e.children,d=e.params,f=e.proFieldProps,h=e.mode,m=e.valueEnum,v=e.request,w=e.options,k=(0,a.Z)(e,l),y=(0,r.Z)({options:w,mode:h||"multiple",labelInValue:!0,showSearch:!0,showArrow:!1,autoClearSearchValue:!0,optionLabelProp:"label"},t),x=(0,s.useContext)(c.Z);return(0,u.jsx)(i.Z,(0,r.Z)((0,r.Z)({valueEnum:(0,o.h)(m),request:v,params:d,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:(0,r.Z)({getPopupContainer:x.getPopupContainer},y),ref:n,proFieldProps:f},k),{},{children:p}))})),h=d;h.SearchSelect=f,h.displayName="ProFormComponent",n.Z=h},17409:function(e,n,t){t.r(n),t.d(n,{default:function(){return Z}});var r=t(35290),a=t.n(r),u=t(411),o=t.n(u),s=t(46686),c=t.n(s),i=t(10305),p=t(13246),l=t(51955),d=t(59019),f=t(62995),h=t(93236),m=t(12188),v=t(10571),w=t(37655),k=t(1896),y=t(62086),x=function(e){var n=(0,h.useRef)();return(0,y.jsxs)(v.Y,{formRef:n,visible:e.updateModalVisible,layout:"horizontal",title:"添加权限",autoFocusFirstInput:!0,modalProps:{destroyOnClose:!0,onCancel:function(){return e.onCancel()}},submitTimeout:2e3,onFinish:function(){var n=o()(a()().mark((function n(t){return a()().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:e.onSubmit();case 1:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),width:440,children:[(0,y.jsx)(w.Z,{name:"namespace_alias",label:"命名空间名称",showSearch:!0,options:e.namespaceoptions,rules:[{required:!0,message:"请选择命名空间名称"}],fieldProps:{onChange:function(t,r){e.getChooseOption({value:r.value,label:r.label}),null==n||n.current.setFieldsValue({namespace_uid:t})}}}),(0,y.jsx)(k.Z,{width:"xl",required:!0,name:"namespace_uid",label:"命名空间标识",disabled:!0})]})},b=t(50251),P=t(21552),Z=function(){var e=(0,h.useState)(!1),n=c()(e,2),t=n[0],r=n[1],u=(0,h.useState)({}),s=c()(u,2),v=s[0],w=s[1],k=(0,h.useState)(""),Z=c()(k,2),_=Z[0],C=Z[1],S=(0,h.useRef)(),g=(0,h.useState)([]),q=c()(g,2),T=q[0],E=q[1],F=(0,h.useState)(""),I=c()(F,2),j=I[0],R=I[1],L=(0,m.useLocation)(),V=function(){var e=o()(a()().mark((function e(n){var t;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,P.JF)({namespace:n.namespace_uid,ak:n.ak});case 2:0==(null==(t=e.sent)?void 0:t.code)?(l.ZP.success("删除成功"),null==S||S.current.reload()):l.ZP.error((null==t?void 0:t.mes)||"操作失败，请稍后再试");case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),G=function(){var e=o()(a()().mark((function e(){var n,t,r,u;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,P.Xd)({});case 2:r=e.sent,console.log(r),0==(null==r?void 0:r.code)&&(null==r||null===(n=r.data)||void 0===n||null===(t=n.items)||void 0===t?void 0:t.length)>0&&(u=[],r.data.items.map((function(e){u.push({label:e.namespace_alias,value:e.namespace_uid})})),E(u));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,h.useEffect)((function(){G()}),[]);var K=[{title:"命名空间名称",dataIndex:"namespace_alias"},{title:"命名空间标识",dataIndex:"namespace_uid",hideInSearch:!0},{title:"权限",dataIndex:"authority",valueType:"text",hideInSearch:!0,render:function(){return"只读"}},{title:"更新人",hideInSearch:!0,dataIndex:"updater",hideInForm:!0},{title:"更新时间",hideInSearch:!0,dataIndex:"update_time",hideInForm:!0},{title:"操作",dataIndex:"option",valueType:"option",render:function(e,n,t,r){return(0,y.jsx)(y.Fragment,{children:(0,y.jsx)(d.Z,{placement:"topLeft",title:"确认删除".concat(null==n?void 0:n.namespace_alias,"对空间命名标识").concat(null==n?void 0:n.ak,"的访问授权吗"),onConfirm:function(){V(n)},okText:"确定",cancelText:"取消",children:(0,y.jsx)("a",{style:{marginRight:8},children:"删除"})})})}}];return(0,y.jsxs)(i._z,{header:{title:"AccessKey空间权限"},children:[(0,y.jsx)(p.Z,{actionRef:S,rowKey:"namespace_uid",search:!1,options:!1,headerTitle:[(0,y.jsx)(f.Z,{type:"primary",onClick:function(){r(!0),w(""),C("添加")},children:"添加"},"keyadd")],request:function(){var e=o()(a()().mark((function e(n,t,r){var u,o,s,c;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,P.R8)({ak:null===(u=L.state)||void 0===u?void 0:u.ak});case 2:return o=e.sent,s=o.data,c=o.success,e.abrupt("return",{data:s||[],success:c});case 6:case"end":return e.stop()}}),e)})));return function(n,t,r){return e.apply(this,arguments)}}(),columns:K,rowClassName:function(e,n){var t=b.Z.lightRow;return n%2==1&&(t=b.Z.darkRow),t}}),(0,y.jsx)(x,{formType:_,onSubmit:o()(a()().mark((function e(){var n,t;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,P.VK)({ak:null===(n=L.state)||void 0===n?void 0:n.ak,namespace:j});case 2:0==(null==(t=e.sent)?void 0:t.code)?(l.ZP.success("操作成功"),null==S||S.current.reload(),r(!1)):l.ZP.error((null==t?void 0:t.msg)||"操作失败，请稍后再试");case 4:case"end":return e.stop()}}),e)}))),onCancel:function(){r(!1),w({})},updateModalVisible:t,values:v,namespaceoptions:T,getChooseOption:function(e){R(e.value)}})]})}},21552:function(e,n,t){t.d(n,{Ct:function(){return _},JF:function(){return h},Kn:function(){return c},N4:function(){return P},R8:function(){return d},VK:function(){return k},Xd:function(){return v},ab:function(){return x},ik:function(){return p}});var r=t(35290),a=t.n(r),u=t(411),o=t.n(u),s=t(12188);function c(e){return i.apply(this,arguments)}function i(){return(i=o()(a()().mark((function e(n){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,s.request)("/api/v1/namespace/".concat(n.namespace,"/access_key"),{method:"GET"}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function p(e){return l.apply(this,arguments)}function l(){return(l=o()(a()().mark((function e(n){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,s.request)("/api/v1/access_key/".concat(n.namespace,"/").concat(n.alias),{method:"POST",data:n}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function d(e){return f.apply(this,arguments)}function f(){return(f=o()(a()().mark((function e(n){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,s.request)("/api/v1/access_key/".concat(n.ak,"/namespace"),{method:"GET"}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function h(e){return m.apply(this,arguments)}function m(){return(m=o()(a()().mark((function e(n){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,s.request)("/api/v1/namespace/".concat(n.namespace,"/access_key/").concat(n.ak),{method:"DELETE"}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function v(e){return w.apply(this,arguments)}function w(){return(w=o()(a()().mark((function e(n){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,s.request)("/api/v1/namespace",{method:"GET"}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function k(e){return y.apply(this,arguments)}function y(){return(y=o()(a()().mark((function e(n){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,s.request)("/api/v1/namespace/".concat(n.namespace,"/access_key/").concat(n.ak),{method:"POST",data:n}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function x(e){return b.apply(this,arguments)}function b(){return(b=o()(a()().mark((function e(n){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,s.request)("/api/v1/access_key",{method:"GET"}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function P(e){return Z.apply(this,arguments)}function Z(){return(Z=o()(a()().mark((function e(n){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,s.request)("/api/v1/access_key/".concat(n.ak),{method:"DELETE"}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function _(e){return C.apply(this,arguments)}function C(){return(C=o()(a()().mark((function e(n){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,s.request)("/api/v1/access_key/".concat(n.ak),{method:"PUT",data:n}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},50251:function(e,n){n.Z={darkRow:"darkRow___94Git","panel-table":"panel-table___tjWYN"}}}]);
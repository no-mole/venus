"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[875],{91977:function(e,n,t){t.d(n,{Z:function(){return g}});var r=t(35290),a=t.n(r),i=t(30279),o=t.n(i),u=t(411),l=t.n(u),s=t(46686),c=t.n(s),d=t(10571),f=t(76405),p=t(1896),m=t(87679),h=t(93236),v=t(69840),x=(t(28768),t(66215),t(36941),t(13838),t(95368),t(3531),t(49355),t(63987),t(72054),t(62644),t(35757),t(79132),t(7699),t(13424),t(94602),t(57860),t(78035),t(42150),t(62086)),y=function(e){var n,t=e.codeValue,r=e.type,a=e.formType,i=e.changeCode,o=(0,h.useState)(""),u=c()(o,2),l=u[0],s=u[1];return(0,h.useEffect)((function(){setTimeout((function(){var e,r;(n=null===(e=document)||void 0===e||null===(r=e.querySelector("div.CodeMirror"))||void 0===r?void 0:r.CodeMirror).refresh(),s("string"==typeof t?JSON.parse(t):JSON.stringify(t,null,2))}),500)}),[]),(0,h.useEffect)((function(){var e,t;n=null===(e=document)||void 0===e||null===(t=e.querySelector("div.CodeMirror"))||void 0===t?void 0:t.CodeMirror,setTimeout((function(){n.refresh()}),100)}),[r]),(0,x.jsx)(x.Fragment,{children:(0,x.jsx)(v.fk,{value:l,onBeforeChange:function(e,n,t){t&&(i(e,n,t),"新建"!==a&&"编辑"!==a||s(t))},options:{lineWrapping:!0,autofocus:!0,indentWithTabs:!0,mode:{name:"yaml"===r||"toml"===r||"properties"===r?"text/x-"+r:"text/jsx",json:!0},theme:"material",lineNumbers:!0,readOnly:"详情"===a,smartIndent:!0,indentUnit:4,foldGutter:!0,styleActiveLine:!0,matchBrackets:!0,autoRefresh:!0,gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter","CodeMirror-lint-markers"],extraKeys:{Ctrl:"autocomplete","Ctrl-S":function(e){},"Ctrl-Z":function(e){e.undo()},F8:function(e){e.redo()}},autoCloseBrackets:!0}})})},g=function(e){var n,t,r=(0,h.useRef)(),i=(0,h.useState)(),u=c()(i,2),s=u[0],v=u[1],g=(0,h.useState)(""),j=c()(g,2),C=j[0],b=j[1];(0,h.useEffect)((function(){var e;b(null==r||null===(e=r.current)||void 0===e?void 0:e.getFieldValue(type))}),[]),(0,h.useEffect)((function(){var n;v(null==e||null===(n=e.values)||void 0===n?void 0:n.value)}),[null==e||null===(n=e.values)||void 0===n?void 0:n.value]);return(0,x.jsxs)(d.Y,{initialValues:e.values,formRef:r,title:"配置".concat(e.formType),open:e.updateModalVisible,autoFocusFirstInput:!0,modalProps:{destroyOnClose:!0,onCancel:function(){return e.onCancel()}},submitTimeout:2e3,onFinish:function(){var n=l()(a()().mark((function n(t){var r;return a()().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:r=o()(o()({},t),{},{value:s}),e.onSubmit(r);case 2:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),width:640,disabled:"详情"===e.formType,children:[(0,x.jsx)(f.A.Group,{children:(0,x.jsx)(p.Z,{width:"xl",name:"alias",label:"配置名称",rules:[{required:!0,message:"请输入配置名称！"}]})}),(0,x.jsx)(f.A.Group,{children:(0,x.jsx)(p.Z,{width:"xl",name:"key",label:"唯一标识",rules:[{required:!0,message:"请输入唯一标识！"}]})}),(0,x.jsx)(f.A.Group,{children:(0,x.jsx)(p.Z,{width:"xl",name:"description",label:"描述"})}),(0,x.jsx)(f.A.Group,{children:(0,x.jsx)(m.Z.Group,{name:"data_type",label:"数据类型",options:["text","json","yaml","toml","properties","ini"],rules:[{required:!0,message:"请选择数据类型！"}],fieldProps:{onChange:function(e){var n;null==r||r.current.setFieldsValue({type:e.target.value}),b(e.target.value),console.log(null==r||null===(n=r.current)||void 0===n?void 0:n.getFieldValue("type"))}}})}),"详情"===e.formType?(0,x.jsx)(f.A.Group,{children:(0,x.jsx)(p.Z,{disabled:!0,width:"xl",name:"version",label:"数据版本",rules:[{required:!0,message:"请输入数据版本！"}]})}):"",(0,x.jsxs)("p",{style:{marginBottom:20},children:[(0,x.jsx)("em",{style:{color:"#ff4d4f",marginInlineEnd:4},children:"*"}),"配置内容:"]}),(0,x.jsx)(y,{changeCode:function(e,n,t){t&&v(JSON.stringify(t))},codeValue:null==e||null===(t=e.values)||void 0===t?void 0:t.value,type:C,setDataType:b,formType:e.formType})]})}},94969:function(e,n,t){t.r(n);var r=t(35290),a=t.n(r),i=t(30279),o=t.n(i),u=t(411),l=t.n(u),s=t(46686),c=t.n(s),d=t(10305),f=t(13246),p=t(23258),m=t(93236),h=t(91977),v=t(78076),x=t(22240),y=t(62086);n.default=function(){var e=(0,p.useLocation)().search,n=new URLSearchParams(e),t=n.get("namespace"),r=n.get("key"),i=n.get("alias"),u=(0,m.useRef)(),s=(0,m.useState)(!1),g=c()(s,2),j=g[0],C=g[1],b=(0,m.useState)({}),k=c()(b,2),w=k[0],S=k[1],T=(0,m.useState)(""),I=c()(T,2),Z=I[0],F=I[1],R=[{title:"配置项名称",dataIndex:"alias",hideInSearch:!0},{title:"唯一标识",dataIndex:"key",hideInSearch:!0},{title:"版本",hideInSearch:!0,dataIndex:"version",hideInForm:!0},{title:"最近更新时间",hideInSearch:!0,dataIndex:"update_time",valueType:"dateTime",hideInForm:!0},{title:"操作",render:function(e,n){return(0,y.jsx)(y.Fragment,{children:(0,y.jsx)("a",{onClick:function(){C(!0),S(n),F("详情")},rel:"noopener noreferrer",style:{marginRight:8},children:"查看"})})}}];return(0,y.jsxs)(d._z,{header:{title:"".concat(i,"配置历史列表")},children:[(0,y.jsx)(f.Z,{headerTitle:"",actionRef:u,rowKey:"id",search:!1,request:function(){var e=l()(a()().mark((function e(n,i,u){var l,s,c;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,x.Sk)(o()(o()({namespace:t,key:r},n),{},{sorter:i,filter:u}));case 2:return l=e.sent,s=l.data,c=l.success,e.abrupt("return",{data:s||[],success:c});case 6:case"end":return e.stop()}}),e)})));return function(n,t,r){return e.apply(this,arguments)}}(),columns:R,rowClassName:function(e,n){var t=v.Z.lightRow;return n%2==1&&(t=v.Z.darkRow),t}}),(0,y.jsx)(h.Z,{formType:Z,onSubmit:l()(a()().mark((function e(){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),onCancel:function(){C(!1),S({})},updateModalVisible:j,values:w})]})}},78076:function(e,n){n.Z={darkRow:"darkRow___94Git","panel-table":"panel-table___tjWYN"}}}]);
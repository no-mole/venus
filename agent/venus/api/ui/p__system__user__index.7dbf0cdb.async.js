"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[472],{87679:function(e,r,n){var t=n(56453),u=n(30486),a=n(62086),o=n(63502),i=n(50695),s=n(93236),c=n(97162),l=n(12961),d=["fieldProps","options","radioType","layout","proFieldProps","valueEnum"],p=s.forwardRef((function(e,r){var n=e.fieldProps,i=e.options,s=e.radioType,c=e.layout,p=e.proFieldProps,f=e.valueEnum,h=(0,u.Z)(e,d);return(0,a.jsx)(l.Z,(0,t.Z)((0,t.Z)({valueType:"button"===s?"radioButton":"radio",ref:r,valueEnum:(0,o.h)(f,void 0)},h),{},{fieldProps:(0,t.Z)({options:i,layout:c},n),proFieldProps:p,filedConfig:{customLightMode:!0}}))})),f=s.forwardRef((function(e,r){var n=e.fieldProps,u=e.children;return(0,a.jsx)(i.ZP,(0,t.Z)((0,t.Z)({},n),{},{ref:r,children:u}))})),h=(0,c.G)(f,{valuePropName:"checked",ignoreWidth:!0});h.Group=p,h.Button=i.ZP.Button,h.displayName="ProFormComponent",r.Z=h},38303:function(e,r,n){var t=n(30486),u=n(56453),a=n(62086),o=n(90413),i=n(53910),s=n(6310),c=n(41930),l=n(57910),d=n(62995),p=n(84875),f=n.n(p),h=n(93236),m=["key","name"],v=function(e){var r=e.className,n=e.style,o=e.onSelect,d=e.menus,p=void 0===d?[]:d,v=e.children,x=(0,(0,h.useContext)(c.ZP.ConfigContext).getPrefixCls)("pro-table-dropdown"),y=(0,s.Q)({onClick:function(e){null==o||o(e.key)},items:p.map((function(e){var r=e.key,n=e.name,a=(0,t.Z)(e,m);return(0,u.Z)((0,u.Z)({key:r},a),{},{title:a.title,label:n})}))});return(0,a.jsx)(l.Z,(0,u.Z)((0,u.Z)({},y),{},{className:f()(x,r),children:(0,a.jsx)("a",{style:n,children:v||(0,a.jsx)(i.Z,{})})}))};v.Button=function(e){var r=e.children,n=e.menus,t=e.onSelect,i=e.className,p=e.style,m=(0,(0,h.useContext)(c.ZP.ConfigContext).getPrefixCls)("pro-table-dropdown"),v=(0,s.Q)({onClick:function(e){return t&&t(e.key)},items:null==n?void 0:n.map((function(e){return{label:e.name,key:e.key}}))});return(0,a.jsx)(l.Z,(0,u.Z)((0,u.Z)({},v),{},{className:f()(m,i),children:(0,a.jsxs)(d.Z,{style:p,children:[r," ",(0,a.jsx)(o.Z,{})]})}))},r.Z=v},86039:function(e,r,n){n.r(r),n.d(r,{default:function(){return I}});var t=n(30279),u=n.n(t),a=n(35290),o=n.n(a),i=n(411),s=n.n(i),c=n(46686),l=n.n(c),d=n(38303),p=n(10305),f=n(13246),h=n(59019),m=n(51955),v=n(62995),x=n(93236),y=n(12188),Z=n(10571),w=n(76405),b=n(1896),k=n(87679),j=n(54189),g=n(62086),P=function(e){return(0,g.jsxs)(Z.Y,{initialValues:e.values,open:e.updateModalVisible,autoFocusFirstInput:!0,modalProps:{destroyOnClose:!0,onCancel:function(){return e.onCancel()}},submitTimeout:2e3,onFinish:function(){var r=s()(o()().mark((function r(n){return o()().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:e.onSubmit(n);case 1:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}(),width:440,children:[(0,g.jsx)(w.A.Group,{children:(0,g.jsx)(b.Z,{width:"xl",name:"name",label:"用户名",rules:[{required:!0,message:"请输入用户名！"}]})}),(0,g.jsx)(w.A.Group,{children:(0,g.jsx)(b.Z,{width:"xl",name:"uid",label:"邮箱",rules:[{type:"email",message:"请输入正确的电子邮箱"},{required:!0,message:"请输入邮箱！"}]})}),(0,g.jsx)(w.A.Group,{children:(0,g.jsx)(b.Z.Password,{width:"xl",name:"password",label:"密码"})}),(0,g.jsx)(w.A.Group,{children:(0,g.jsx)(k.Z.Group,{name:"role",label:"权限",options:["普通成员","管理员"],rules:[{required:!0,message:"请选择权限！"}]})})]})},C=n(48116),I=function(){var e,r=(0,x.useState)(!1),n=l()(r,2),t=n[0],a=n[1],i=(0,x.useState)({}),c=l()(i,2),Z=c[0],w=c[1],b=(0,x.useState)(""),k=l()(b,2),I=k[0],R=k[1],S=(0,x.useRef)(),T=(null===(e=localStorage)||void 0===e||e.getItem("uid"),[{title:"关键词",dataIndex:"keyword",hideInTable:!0},{title:"用户名",dataIndex:"name",hideInSearch:!0},{title:"邮箱",dataIndex:"uid",valueType:"text",hideInSearch:!0},{title:"创建时间",hideInSearch:!0,dataIndex:"update_time",hideInForm:!0,valueType:"date"},{title:"创建者",hideInSearch:!0,dataIndex:"updater",hideInForm:!0},{title:"角色",hideInSearch:!0,dataIndex:"role",hideInForm:!0,render:function(e){return"UserRoleAdministrator"===e?"管理员":"UserRoleMember"===e?"普通成员":e}},{title:"操作",dataIndex:"option",valueType:"option",render:function(e,r,n,t){return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)("a",{onClick:function(){console.log("record",r),y.history.push({pathname:"/system/user/detail?uid=".concat(null==r?void 0:r.uid)})},rel:"noopener noreferrer",style:{marginRight:8},children:"查看"}),(0,g.jsx)(h.Z,{placement:"topLeft",title:"确认删除吗",onConfirm:function(){F(r)},okText:"删除",cancelText:"取消",children:(0,g.jsx)("a",{style:{marginRight:8},children:"删除"})}),(0,g.jsx)(d.Z,{onSelect:function(){var e=s()(o()().mark((function e(n){var t;return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("reset-pasword"!=n){e.next=13;break}return e.prev=1,e.next=4,(0,j.zb)({uid:null==r?void 0:r.uid});case 4:return m.ZP.success("重置成功"),null===(t=S.current)||void 0===t||t.reload(),e.abrupt("return",!0);case 9:return e.prev=9,e.t0=e.catch(1),m.ZP.error("重置失败，请重试"),e.abrupt("return",!1);case 13:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(r){return e.apply(this,arguments)}}(),menus:[{key:"reset-pasword",name:"重置密码"},{key:"disable-login",name:"禁止登录"}]},"actionGroup")]})}}]),F=function(){var e=s()(o()().mark((function e(r){var n,t;return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=m.ZP.loading("正在删除"),r){e.next=3;break}return e.abrupt("return",!0);case 3:return e.prev=3,e.next=6,(0,j.h8)({uid:null==r?void 0:r.uid});case 6:return n(),m.ZP.success("删除成功"),null===(t=S.current)||void 0===t||t.reload(),e.abrupt("return",!0);case 12:return e.prev=12,e.t0=e.catch(3),n(),m.ZP.error("删除失败，请重试"),e.abrupt("return",!1);case 17:case"end":return e.stop()}}),e,null,[[3,12]])})));return function(r){return e.apply(this,arguments)}}();return(0,g.jsxs)(p._z,{header:{title:"用户管理"},children:[(0,g.jsx)(f.Z,{headerTitle:"",actionRef:S,rowKey:function(e){return null==e?void 0:e.namespace_uid},search:{labelWidth:60},toolBarRender:function(){return[(0,g.jsx)(v.Z,{type:"primary",onClick:function(){a(!0),w(""),R("新建")},children:"新建"},"new")]},request:function(){var e=s()(o()().mark((function e(r,n,t){var a,i,s;return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,j.lE)(u()(u()({},r),{},{sorter:n,filter:t}));case 2:return a=e.sent,i=a.data,s=a.success,e.abrupt("return",{data:(null==i?void 0:i.items)||[],success:s});case 6:case"end":return e.stop()}}),e)})));return function(r,n,t){return e.apply(this,arguments)}}(),columns:T,rowClassName:function(e,r){var n=C.Z.lightRow;return r%2==1&&(n=C.Z.darkRow),n}}),(0,g.jsx)(P,{formType:I,onSubmit:function(){var e=s()(o()().mark((function e(r){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,j.MZ)(u()(u()({},r),{},{role:"普通成员"===(null==r?void 0:r.role)?"UserRoleMember":"UserRoleAdministrator"}));case 2:e.sent&&(m.ZP.success("成功"),a(!1),w(""),S.current&&S.current.reload());case 4:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),onCancel:function(){a(!1),w("")},updateModalVisible:t,values:Z})]})}},54189:function(e,r,n){n.d(r,{MZ:function(){return s},h8:function(){return h},kf:function(){return p},lE:function(){return l},zb:function(){return v}});var t=n(35290),u=n.n(t),a=n(411),o=n.n(a),i=n(12188);function s(e){return c.apply(this,arguments)}function c(){return(c=o()(u()().mark((function e(r){return u()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,i.request)("/api/v1/user/".concat(r.uid),{method:"post",data:r}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function l(e){return d.apply(this,arguments)}function d(){return(d=o()(u()().mark((function e(r){return u()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,i.request)("/api/v1/user",{method:"get",params:r}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function p(e){return f.apply(this,arguments)}function f(){return(f=o()(u()().mark((function e(r){return u()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,i.request)("/api/v1/user/".concat(r.uid,"/namespace"),{method:"get",params:r}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function h(e){return m.apply(this,arguments)}function m(){return(m=o()(u()().mark((function e(r){return u()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,i.request)("/api/v1/user/".concat(r.uid),{method:"delete",data:r}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function v(e){return x.apply(this,arguments)}function x(){return(x=o()(u()().mark((function e(r){return u()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,i.request)("/api/v1/user/".concat(r.uid),{method:"put",data:r}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},48116:function(e,r){r.Z={darkRow:"darkRow___vSlcb","panel-table":"panel-table___ITOh_"}}}]);